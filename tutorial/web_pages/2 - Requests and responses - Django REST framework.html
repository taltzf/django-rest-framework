<!DOCTYPE html>
<html lang="en"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>2 - Requests and responses - Django REST framework</title>
  <link href="http://www.django-rest-framework.org/img/favicon.ico" rel="icon" type="image/x-icon">
  <link rel="canonical" href="http://www.django-rest-framework.org/tutorial/2-requests-and-responses/">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Django, API, REST, 2 - Requests and responses">
  <meta name="author" content="Tom Christie">

  <!-- Le styles -->
  <link href="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/prettify.css" rel="stylesheet">
  <link href="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/bootstrap.css" rel="stylesheet">
  <link href="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/bootstrap-responsive.css" rel="stylesheet">
  <link href="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/default.css" rel="stylesheet">

  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <script type="text/javascript" async="" src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/ga.js"></script><script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-18852272-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  </script>

  <style>
  #sidebarInclude img {
      margin-bottom: 10px;
  }
  #sidebarInclude a.promo {
      color: black;
  }
    @media (max-width: 767px) {
      div.promo {
        display: none;
      }
    }
  </style>
</head>
<body onload="prettyPrint()" class="-page">

  <div class="wrapper">
        <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="repo-link btn btn-primary btn-small" href="https://github.com/encode/django-rest-framework/tree/master">GitHub</a>
          <a class="repo-link btn btn-inverse btn-small " rel="prev" href="http://www.django-rest-framework.org/tutorial/3-class-based-views/">
            Next <i class="icon-arrow-right icon-white"></i>
          </a>
          <a class="repo-link btn btn-inverse btn-small " rel="next" href="http://www.django-rest-framework.org/tutorial/1-serialization/">
            <i class="icon-arrow-left icon-white"></i> Previous
          </a>
          <a id="search_modal_show" class="repo-link btn btn-inverse btn-small" href="#mkdocs_search_modal" data-toggle="modal" data-target="#mkdocs_search_modal"><i class="icon-search icon-white"></i> Search</a>
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://www.django-rest-framework.org/">Django REST framework</a>
          <div class="nav-collapse collapse">
            
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
               
              <li>
                <a href="http://www.django-rest-framework.org/">Home</a>
              </li>
                
              <li class="dropdown active">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial <b class="caret"></b></a>
                <ul class="dropdown-menu" style="max-height: 538px;">
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/tutorial/quickstart/">Quickstart</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/tutorial/1-serialization/">1 - Serialization</a>
                  </li>
                  
                  <li class="active">
                    <a href="http://www.django-rest-framework.org/tutorial/2-requests-and-responses/">2 - Requests and responses</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/tutorial/3-class-based-views/">3 - Class based views</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/tutorial/4-authentication-and-permissions/">4 - Authentication and permissions</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/tutorial/5-relationships-and-hyperlinked-apis/">5 - Relationships and hyperlinked APIs</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/tutorial/6-viewsets-and-routers/">6 - Viewsets and routers</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/tutorial/7-schemas-and-client-libraries/">7 - Schemas and client libraries</a>
                  </li>
                  
                </ul>
              </li>
                
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">API Guide <b class="caret"></b></a>
                <ul class="dropdown-menu" style="max-height: 538px;">
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/requests/">Requests</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/responses/">Responses</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/views/">Views</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/generic-views/">Generic views</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/viewsets/">Viewsets</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/routers/">Routers</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/parsers/">Parsers</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/renderers/">Renderers</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/serializers/">Serializers</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/fields/">Serializer fields</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/relations/">Serializer relations</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/validators/">Validators</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/authentication/">Authentication</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/permissions/">Permissions</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/throttling/">Throttling</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/filtering/">Filtering</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/pagination/">Pagination</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/versioning/">Versioning</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/content-negotiation/">Content negotiation</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/metadata/">Metadata</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/schemas/">Schemas</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/format-suffixes/">Format suffixes</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/reverse/">Returning URLs</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/exceptions/">Exceptions</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/status-codes/">Status codes</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/testing/">Testing</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/api-guide/settings/">Settings</a>
                  </li>
                  
                </ul>
              </li>
                
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topics <b class="caret"></b></a>
                <ul class="dropdown-menu" style="max-height: 538px;">
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/documenting-your-api/">Documenting your API</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/api-clients/">API Clients</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/internationalization/">Internationalization</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/ajax-csrf-cors/">AJAX, CSRF &amp; CORS</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/html-and-forms/">HTML &amp; Forms</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/browser-enhancements/">Browser Enhancements</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/browsable-api/">The Browsable API</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/rest-hypermedia-hateoas/">REST, Hypermedia &amp; HATEOAS</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/third-party-packages/">Third Party Packages</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/tutorials-and-resources/">Tutorials and Resources</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/contributing/">Contributing to REST framework</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/project-management/">Project management</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/jobs/">Jobs</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.0-announcement/">3.0 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.1-announcement/">3.1 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.2-announcement/">3.2 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.3-announcement/">3.3 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.4-announcement/">3.4 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.5-announcement/">3.5 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.6-announcement/">3.6 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/3.7-announcement/">3.7 Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/kickstarter-announcement/">Kickstarter Announcement</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/mozilla-grant/">Mozilla Grant</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/funding/">Funding</a>
                  </li>
                  
                  <li>
                    <a href="http://www.django-rest-framework.org/topics/release-notes/">Release Notes</a>
                  </li>
                  
                </ul>
              </li>
               

            </ul>
            
          </div>
          <!--/.nav-collapse -->

        </div>
      </div>
    </div>

    <div class="body-content">
      <div class="container-fluid">
        <!-- Search Modal -->
        <div id="mkdocs_search_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Documentation search</h3>
          </div>

          <div class="modal-body">
            <form role="form" autocomplete="off">
              <div class="form-group">
                <input name="q" class="form-control" placeholder="Search..." id="mkdocs-search-query" type="text">
              </div>
            </form>
            <div id="mkdocs-search-results"></div>
          </div>

          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
          </div>
        </div>

        <div class="row-fluid">
          <div class="span3">
            <div id="table-of-contents">
              <ul class="nav nav-list side-nav well sidebar-nav-fixed" style="max-height: 538px;">
                

                
                  <li class="main">
                    <a href="#tutorial-2-requests-and-responses">Tutorial 2: Requests and Responses</a>
                  </li>

                  
                    <li>
                      <a href="#request-objects">Request objects</a>
                    </li>
                  
                    <li>
                      <a href="#response-objects">Response objects</a>
                    </li>
                  
                    <li>
                      <a href="#status-codes">Status codes</a>
                    </li>
                  
                    <li>
                      <a href="#wrapping-api-views">Wrapping API views</a>
                    </li>
                  
                    <li>
                      <a href="#pulling-it-all-together">Pulling it all together</a>
                    </li>
                  
                    <li>
                      <a href="#adding-optional-format-suffixes-to-our-urls">Adding optional format suffixes to our URLs</a>
                    </li>
                  
                    <li>
                      <a href="#hows-it-looking">How's it looking?</a>
                    </li>
                  
                    <li>
                      <a href="#whats-next">What's next?</a>
                    </li>
                  
                

                  <div class="promo">
                    <hr>
                    <div id="sidebarInclude"><a href="https://about.holvi.com/careers/"><img src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/holvi-logo-green-small.jpg" width="130px"></a><p><a class="promo" href="https://about.holvi.com/careers/">Join us in building a new type of banking service for European entrepreneurs and freelancers.</a></p><p><a href="https://fund.django-rest-framework.org/topics/funding/">Fund Django REST framework</a></p></div>
              </div></ul>

            </div>
          </div>

          <div id="main-content" class="span9">
            
              

              <h1 id="tutorial-2-requests-and-responses"><a class="toclink" href="#tutorial-2-requests-and-responses">Tutorial 2: Requests and Responses</a></h1>
<p>From this point we're going to really start covering the core of REST framework.
Let's introduce a couple of essential building blocks.</p>
<h2 id="request-objects"><a class="toclink" href="#request-objects">Request objects</a></h2>
<p>REST framework introduces a <code>Request</code> object that extends the regular <code>HttpRequest</code>, and provides more flexible request parsing.  The core functionality of the <code>Request</code> object is the <code>request.data</code> attribute, which is similar to <code>request.POST</code>, but more useful for working with Web APIs.</p>
<pre class="prettyprint well"><code><span class="pln">request</span><span class="pun">.</span><span class="pln">POST  </span><span class="com"># Only handles form data.  Only works for 'POST' method.</span><span class="pln">
request</span><span class="pun">.</span><span class="pln">data  </span><span class="com"># Handles arbitrary data.  Works for 'POST', 'PUT' and 'PATCH' methods.</span></code></pre>
<h2 id="response-objects"><a class="toclink" href="#response-objects">Response objects</a></h2>
<p>REST framework also introduces a <code>Response</code> object, which is a type of <code>TemplateResponse</code> that takes unrendered content and uses content negotiation to determine the correct content type to return to the client.</p>
<pre class="prettyprint well"><code><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">data</span><span class="pun">)</span><span class="pln">  </span><span class="com"># Renders to content type as requested by the client.</span></code></pre>
<h2 id="status-codes"><a class="toclink" href="#status-codes">Status codes</a></h2>
<p>Using numeric HTTP status codes in your views doesn't always make for
 obvious reading, and it's easy to not notice if you get an error code 
wrong.  REST framework provides more explicit identifiers for each 
status code, such as <code>HTTP_400_BAD_REQUEST</code> in the <code>status</code> module.  It's a good idea to use these throughout rather than using numeric identifiers.</p>
<h2 id="wrapping-api-views"><a class="toclink" href="#wrapping-api-views">Wrapping API views</a></h2>
<p>REST framework provides two wrappers you can use to write API views.</p>
<ol>
<li>The <code>@api_view</code> decorator for working with function based views.</li>
<li>The <code>APIView</code> class for working with class-based views.</li>
</ol>
<p>These wrappers provide a few bits of functionality such as making sure you receive <code>Request</code> instances in your view, and adding context to <code>Response</code> objects so that content negotiation can be performed.</p>
<p>The wrappers also provide behaviour such as returning <code>405 Method Not Allowed</code> responses when appropriate, and handling any <code>ParseError</code> exception that occurs when accessing <code>request.data</code> with malformed input.</p>
<h2 id="pulling-it-all-together"><a class="toclink" href="#pulling-it-all-together">Pulling it all together</a></h2>
<p>Okay, let's go ahead and start using these new components to write a few views.</p>
<p>We don't need our <code>JSONResponse</code> class in <code>views.py</code> any more, so go ahead and delete that.  Once that's done we can start refactoring our views slightly.</p>
<pre class="prettyprint well"><code><span class="kwd">from</span><span class="pln"> rest_framework </span><span class="kwd">import</span><span class="pln"> status
</span><span class="kwd">from</span><span class="pln"> rest_framework</span><span class="pun">.</span><span class="pln">decorators </span><span class="kwd">import</span><span class="pln"> api_view
</span><span class="kwd">from</span><span class="pln"> rest_framework</span><span class="pun">.</span><span class="pln">response </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Response</span><span class="pln">
</span><span class="kwd">from</span><span class="pln"> snippets</span><span class="pun">.</span><span class="pln">models </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Snippet</span><span class="pln">
</span><span class="kwd">from</span><span class="pln"> snippets</span><span class="pun">.</span><span class="pln">serializers </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">SnippetSerializer</span><span class="pln">


</span><span class="lit">@api_view</span><span class="pun">([</span><span class="str">'GET'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'POST'</span><span class="pun">])</span><span class="pln">
</span><span class="kwd">def</span><span class="pln"> snippet_list</span><span class="pun">(</span><span class="pln">request</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""
    List all code snippets, or create a new snippet.
    """</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">method </span><span class="pun">==</span><span class="pln"> </span><span class="str">'GET'</span><span class="pun">:</span><span class="pln">
        snippets </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Snippet</span><span class="pun">.</span><span class="pln">objects</span><span class="pun">.</span><span class="pln">all</span><span class="pun">()</span><span class="pln">
        serializer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SnippetSerializer</span><span class="pun">(</span><span class="pln">snippets</span><span class="pun">,</span><span class="pln"> many</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">serializer</span><span class="pun">.</span><span class="pln">data</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">elif</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">method </span><span class="pun">==</span><span class="pln"> </span><span class="str">'POST'</span><span class="pun">:</span><span class="pln">
        serializer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SnippetSerializer</span><span class="pun">(</span><span class="pln">data</span><span class="pun">=</span><span class="pln">request</span><span class="pun">.</span><span class="pln">data</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> serializer</span><span class="pun">.</span><span class="pln">is_valid</span><span class="pun">():</span><span class="pln">
            serializer</span><span class="pun">.</span><span class="pln">save</span><span class="pun">()</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">serializer</span><span class="pun">.</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> status</span><span class="pun">=</span><span class="pln">status</span><span class="pun">.</span><span class="pln">HTTP_201_CREATED</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">serializer</span><span class="pun">.</span><span class="pln">errors</span><span class="pun">,</span><span class="pln"> status</span><span class="pun">=</span><span class="pln">status</span><span class="pun">.</span><span class="pln">HTTP_400_BAD_REQUEST</span><span class="pun">)</span></code></pre>
<p>Our instance view is an improvement over the previous example.  It's a
 little more concise, and the code now feels very similar to if we were 
working with the Forms API.  We're also using named status codes, which 
makes the response meanings more obvious.</p>
<p>Here is the view for an individual snippet, in the <code>views.py</code> module.</p>
<pre class="prettyprint well"><code><span class="lit">@api_view</span><span class="pun">([</span><span class="str">'GET'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'PUT'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'DELETE'</span><span class="pun">])</span><span class="pln">
</span><span class="kwd">def</span><span class="pln"> snippet_detail</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> pk</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""
    Retrieve, update or delete a code snippet.
    """</span><span class="pln">
    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
        snippet </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Snippet</span><span class="pun">.</span><span class="pln">objects</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">pk</span><span class="pun">=</span><span class="pln">pk</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">except</span><span class="pln"> </span><span class="typ">Snippet</span><span class="pun">.</span><span class="typ">DoesNotExist</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">status</span><span class="pun">=</span><span class="pln">status</span><span class="pun">.</span><span class="pln">HTTP_404_NOT_FOUND</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">method </span><span class="pun">==</span><span class="pln"> </span><span class="str">'GET'</span><span class="pun">:</span><span class="pln">
        serializer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SnippetSerializer</span><span class="pun">(</span><span class="pln">snippet</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">serializer</span><span class="pun">.</span><span class="pln">data</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">elif</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">method </span><span class="pun">==</span><span class="pln"> </span><span class="str">'PUT'</span><span class="pun">:</span><span class="pln">
        serializer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">SnippetSerializer</span><span class="pun">(</span><span class="pln">snippet</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">=</span><span class="pln">request</span><span class="pun">.</span><span class="pln">data</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> serializer</span><span class="pun">.</span><span class="pln">is_valid</span><span class="pun">():</span><span class="pln">
            serializer</span><span class="pun">.</span><span class="pln">save</span><span class="pun">()</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">serializer</span><span class="pun">.</span><span class="pln">data</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">serializer</span><span class="pun">.</span><span class="pln">errors</span><span class="pun">,</span><span class="pln"> status</span><span class="pun">=</span><span class="pln">status</span><span class="pun">.</span><span class="pln">HTTP_400_BAD_REQUEST</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">elif</span><span class="pln"> request</span><span class="pun">.</span><span class="pln">method </span><span class="pun">==</span><span class="pln"> </span><span class="str">'DELETE'</span><span class="pun">:</span><span class="pln">
        snippet</span><span class="pun">.</span><span class="kwd">delete</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">Response</span><span class="pun">(</span><span class="pln">status</span><span class="pun">=</span><span class="pln">status</span><span class="pun">.</span><span class="pln">HTTP_204_NO_CONTENT</span><span class="pun">)</span></code></pre>
<p>This should all feel very familiar - it is not a lot different from working with regular Django views.</p>
<p>Notice that we're no longer explicitly tying our requests or responses to a given content type.  <code>request.data</code> can handle incoming <code>json</code>
 requests, but it can also handle other formats.  Similarly we're 
returning response objects with data, but allowing REST framework to 
render the response into the correct content type for us.</p>
<h2 id="adding-optional-format-suffixes-to-our-urls"><a class="toclink" href="#adding-optional-format-suffixes-to-our-urls">Adding optional format suffixes to our URLs</a></h2>
<p>To take advantage of the fact that our responses are no longer 
hardwired to a single content type let's add support for format suffixes
 to our API endpoints.  Using format suffixes gives us URLs that 
explicitly refer to a given format, and means our API will be able to 
handle URLs such as <a href="http://example.com/api/items/4.json">http://example.com/api/items/4.json</a>.</p>
<p>Start by adding a <code>format</code> keyword argument to both of the views, like so.</p>
<pre class="prettyprint well"><code><span class="kwd">def</span><span class="pln"> snippet_list</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> format</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">):</span></code></pre>
<p>and</p>
<pre class="prettyprint well"><code><span class="kwd">def</span><span class="pln"> snippet_detail</span><span class="pun">(</span><span class="pln">request</span><span class="pun">,</span><span class="pln"> pk</span><span class="pun">,</span><span class="pln"> format</span><span class="pun">=</span><span class="kwd">None</span><span class="pun">):</span></code></pre>
<p>Now update the <code>snippets/urls.py</code> file slightly, to append a set of <code>format_suffix_patterns</code> in addition to the existing URLs.</p>
<pre class="prettyprint well"><code><span class="kwd">from</span><span class="pln"> django</span><span class="pun">.</span><span class="pln">conf</span><span class="pun">.</span><span class="pln">urls </span><span class="kwd">import</span><span class="pln"> url
</span><span class="kwd">from</span><span class="pln"> rest_framework</span><span class="pun">.</span><span class="pln">urlpatterns </span><span class="kwd">import</span><span class="pln"> format_suffix_patterns
</span><span class="kwd">from</span><span class="pln"> snippets </span><span class="kwd">import</span><span class="pln"> views

urlpatterns </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
    url</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^snippets/$'</span><span class="pun">,</span><span class="pln"> views</span><span class="pun">.</span><span class="pln">snippet_list</span><span class="pun">),</span><span class="pln">
    url</span><span class="pun">(</span><span class="pln">r</span><span class="str">'^snippets/(?P&lt;pk&gt;[0-9]+)$'</span><span class="pun">,</span><span class="pln"> views</span><span class="pun">.</span><span class="pln">snippet_detail</span><span class="pun">),</span><span class="pln">
</span><span class="pun">]</span><span class="pln">

urlpatterns </span><span class="pun">=</span><span class="pln"> format_suffix_patterns</span><span class="pun">(</span><span class="pln">urlpatterns</span><span class="pun">)</span></code></pre>
<p>We don't necessarily need to add these extra url patterns in, but it 
gives us a simple, clean way of referring to a specific format.</p>
<h2 id="hows-it-looking"><a class="toclink" href="#hows-it-looking">How's it looking?</a></h2>
<p>Go ahead and test the API from the command line, as we did in <a href="http://www.django-rest-framework.org/tutorial/1-serialization/">tutorial part 1</a>.  Everything is working pretty similarly, although we've got some nicer error handling if we send invalid requests.</p>
<p>We can get a list of all of the snippets, as before.</p>
<pre class="prettyprint well"><code><span class="pln">http http</span><span class="pun">:</span><span class="com">//127.0.0.1:8000/snippets/</span><span class="pln">

HTTP</span><span class="pun">/</span><span class="lit">1.1</span><span class="pln"> </span><span class="lit">200</span><span class="pln"> OK
</span><span class="pun">...</span><span class="pln">
</span><span class="pun">[</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"id"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"title"</span><span class="pun">:</span><span class="pln"> </span><span class="str">""</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"code"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"foo = \"bar\"\n"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"linenos"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"language"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"python"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"style"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"friendly"</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"id"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"title"</span><span class="pun">:</span><span class="pln"> </span><span class="str">""</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"code"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"print \"hello, world\"\n"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"linenos"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"language"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"python"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"style"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"friendly"</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">]</span></code></pre>
<p>We can control the format of the response that we get back, either by using the <code>Accept</code> header:</p>
<pre class="prettyprint well"><code><span class="pln">http http</span><span class="pun">:</span><span class="com">//127.0.0.1:8000/snippets/ Accept:application/json  # Request JSON</span><span class="pln">
http http</span><span class="pun">:</span><span class="com">//127.0.0.1:8000/snippets/ Accept:text/html         # Request HTML</span></code></pre>
<p>Or by appending a format suffix:</p>
<pre class="prettyprint well"><code><span class="pln">http http</span><span class="pun">:</span><span class="com">//127.0.0.1:8000/snippets.json  # JSON suffix</span><span class="pln">
http http</span><span class="pun">:</span><span class="com">//127.0.0.1:8000/snippets.api   # Browsable API suffix</span></code></pre>
<p>Similarly, we can control the format of the request that we send, using the <code>Content-Type</code> header.</p>
<pre class="prettyprint well"><code><span class="com"># POST using form data</span><span class="pln">
http </span><span class="pun">--</span><span class="pln">form POST http</span><span class="pun">:</span><span class="com">//127.0.0.1:8000/snippets/ code="print 123"</span><span class="pln">

</span><span class="pun">{</span><span class="pln">
  </span><span class="str">"id"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"title"</span><span class="pun">:</span><span class="pln"> </span><span class="str">""</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"code"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"print 123"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"linenos"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"language"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"python"</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"style"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"friendly"</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com"># POST using JSON</span><span class="pln">
http </span><span class="pun">--</span><span class="pln">json POST http</span><span class="pun">:</span><span class="com">//127.0.0.1:8000/snippets/ code="print 456"</span><span class="pln">

</span><span class="pun">{</span><span class="pln">
    </span><span class="str">"id"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"title"</span><span class="pun">:</span><span class="pln"> </span><span class="str">""</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"code"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"print 456"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"linenos"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"language"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"python"</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"style"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"friendly"</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>If you add a <code>--debug</code> switch to the <code>http</code> requests above, you will be able to see the request type in request headers.</p>
<p>Now go and open the API in a web browser, by visiting <a href="http://127.0.0.1:8000/snippets/">http://127.0.0.1:8000/snippets/</a>.</p>
<h3 id="browsability"><a class="toclink" href="#browsability">Browsability</a></h3>
<p>Because the API chooses the content type of the response based on the
 client request, it will, by default, return an HTML-formatted 
representation of the resource when that resource is requested by a web 
browser.  This allows for the API to return a fully web-browsable HTML 
representation.</p>
<p>Having a web-browsable API is a huge usability win, and makes 
developing and using your API much easier.  It also dramatically lowers 
the barrier-to-entry for other developers wanting to inspect and work 
with your API.</p>
<p>See the <a href="http://www.django-rest-framework.org/topics/browsable-api/">browsable api</a> topic for more information about the browsable API feature and how to customize it.</p>
<h2 id="whats-next"><a class="toclink" href="#whats-next">What's next?</a></h2>
<p>In <a href="http://www.django-rest-framework.org/tutorial/3-class-based-views/">tutorial part 3</a>, we'll start using class-based views, and see how generic views reduce the amount of code we need to write.</p>
            

          </div> <!--/span-->
        </div> <!--/row-->
      </div> <!--/.fluid-container-->
    </div> <!--/.body content-->
    <div id="push"></div>
  </div> <!--/.wrapper -->

  <footer class="span12">
    <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.
    </p>
  </footer>

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/jquery-1.js"></script>
  <script src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/prettify-1.js"></script>
  <script src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/bootstrap-2.js"></script>
  <script src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/sidebar_include.js"></script>
  <script>var base_url = '../..';</script>
  <script src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/require.js"></script>
  <script src="2%20-%20Requests%20and%20responses%20-%20Django%20REST%20framework_files/theme.js"></script>

  <script>
    var shiftWindow = function() {
      scrollBy(0, -50)
    };

    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);

    $('.dropdown-menu').on('click touchstart', function(event) {
      event.stopPropagation();
    });

    // Dynamically force sidenav/dropdown to no higher than browser window
    $('.side-nav, .dropdown-menu').css('max-height', window.innerHeight - 130);

    $(function() {
      $(window).resize(function() {
        $('.side-nav, .dropdown-menu').css('max-height', window.innerHeight - 130);
      });
    });
  </script>


</body></html>